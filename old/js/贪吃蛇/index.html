<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        div {
            box-sizing: border-box;
        }

        .outside {
            width: 300px;
            height: 300px;
            margin: 20px auto;
            border: 3px solid #000;
            border-radius: 10px;
            background-color: aquamarine;
        }

        .inner {
            width: 215px;
            height: 215px;
            border: 3px solid #000;
            margin: 10px auto;
            position: relative;

        }

        .bottom {
            display: flex;
            justify-content: space-between;
            margin: 20px 30px;
        }

        .snack>div {
            width: 10px;
            height: 10px;
            background-color: red;
            position: absolute;
            border: 1px solid #000;

        }

        .food {
            width: 10px;
            height: 10px;
            background-color: yellow;
            position: absolute;
            top: 200px;
            left: 200px;
        }
    </style>
</head>

<body>
    <div class="outside">
        <div class="inner">
            <!-- ğŸ -->
            <div class="snack">
                <!-- èº«ä½“ -->
                <div></div>
            </div>
            <!-- é£Ÿç‰©   0-200    -->
            <div class="food"></div>
        </div>
        <div class="bottom">
            <div class="score">åˆ†æ•°ï¼š0</div>
            <div class="level">ç­‰çº§ï¼š1</div>
        </div>
    </div>
    <script>
        //   è·å–ğŸçš„å®¹å™¨
        const snack = document.getElementsByClassName('snack')[0]
        //  è·å–è›‡çš„å„ä¸ªéƒ¨åˆ†
        const snacks = snack.getElementsByTagName('div')
        // è·å–é£Ÿç‰©
        const food = document.getElementsByClassName('food')[0]
        // è·å–åˆ†æ•°
        const score = document.getElementsByClassName('score')[0]
        let scoreText = 0 
        // è·å–ç­‰çº§
        const level = document.getElementsByClassName('level')[0]
        let levelText = 1
        // æ§åˆ¶é€Ÿåº¦å¿«æ…¢
        let speed = 300
        // å­˜å‚¨æ–¹å‘
        let dir
        const keyArr = ['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight']
        // åˆ›å»ºä¸€ä¸ªå¯¹è±¡
        const reObj = {
            ArrowUp: 'ArrowDown',
            ArrowDown: 'ArrowUp',
            ArrowLeft: 'ArrowRight',
            ArrowRight: 'ArrowLeft',
        }
        // é˜²æ­¢æŒ‰é”®è¿‡å¿« æ‰å¤´ 
        let keyActive = true
        // ç»‘å®šæŒ‰é”®äº‹ä»¶
        document.addEventListener('keydown', function (e) {
            if (keyActive && keyArr.includes(e.key)) {
                if (snacks.length < 2 || reObj[dir] !== e.key) {
                    dir = e.key
                    keyActive = false
                }
            }
            keyActive = false
        })
        function changeFood() {
            // 0-200 
            const x = Math.floor(Math.random() * 20) * 10
            const y = Math.floor(Math.random() * 20) * 10
            food.style.left = x + 'px'
            food.style.top = y + 'px'
        }
        changeFood()
        setTimeout(
            function move() {
                // è›‡å¤´
                const head = snacks[0]
                // è›‡å¤´åæ ‡
                let x = head.offsetLeft
                let y = head.offsetTop
                switch (dir) {
                    case 'ArrowUp':
                        y -= 10
                        break
                    case 'ArrowDown':
                        y += 10
                        break
                    case 'ArrowLeft':
                        x -= 10
                        break
                    case 'ArrowRight':
                        x += 10
                        break
                }
                // æ£€æŸ¥è›‡æ˜¯å¦åƒåˆ°é£Ÿç‰©
                if (head.offsetTop === food.offsetTop && head.offsetLeft === food.offsetLeft) {
                    // åŠ åˆ†
                    scoreText++
                    score.textContent ='åˆ†æ•°ï¼š'+ scoreText
                    // å‡çº§
                    if (scoreText % 2 ===0 && speed > 0) {
                        levelText++
                        level.textContent ='ç­‰çº§ï¼š'+ levelText
                        // é€Ÿåº¦å˜å¿«
                        speed-=50
                    }
                    // æ”¹å˜é£Ÿç‰©çš„ä½ç½®
                    changeFood()
                    // å¢åŠ è›‡çš„èº«ä½“
                    snack.insertAdjacentHTML('beforeend', '<div></div>')
                }

                // åˆ¤æ–­æ˜¯å¦æ’å¢™
                if (x < 0 || x > 200 || y < 0 || y > 200) {
                    alert('æ’å¢™äº†ï¼Œæ¸¸æˆç»“æŸ')
                    return
                }
                // åˆ¤æ–­æ˜¯å¦æ’åˆ°èº«ä½“

                //                           ä¸åˆ¤æ–­å¤´å’Œå°¾å·´ç¢°æ’
                for (let i = 0; i < snacks.length - 1; i++) {
                    if (snacks[i].offsetLeft === x && snacks[i].offsetTop === y) {
                        alert('æ’åˆ°è‡ªå·±äº†ï¼Œæ¸¸æˆç»“æŸ')
                        return
                    }

                }

                // è·å–å°¾å·´
                const tail = snacks[snacks.length - 1]
                // ç§»åŠ¨è›‡çš„èº«ä½“
                tail.style.left = x + 'px'
                tail.style.top = y + 'px'
                // æŠŠå°¾å·´å˜è›‡å¤´
                snack.insertAdjacentElement('afterbegin', tail)
                keyActive = true
                setTimeout(move, speed)
            }
            , speed)
    </script>
</body>

</html>